@using Crimenuts.App.Web.Models
@using Crimenuts.Utils.Localization
@functions{
    //  >> App_Code | Localization 
    // Now: Localization | App_Code

    // ===================================================================================== []
    // Data
    private static void InitLocalizator()
    {
        Localizator.RegisterLanguage(Lang.En);
        Localizator.RegisterLanguage(Lang.Ru);

        Localizator.Set("Title:Crime Nuts")
            .Set(Lang.En, "Crime Nuts")
            .Set(Lang.Ru, "Криминальные Загадки")
            ;

        Localizator.Set("Menu:Home")
            .Set(Lang.En, "Home")
            .Set(Lang.Ru, "Домой")
            ;
        Localizator.Set("Menu:Cases")
            .Set(Lang.En, "Cases")
            .Set(Lang.Ru, "Дела")
            ;
        Localizator.Set("Menu:Processes")
            .Set(Lang.En, "Processes")
            .Set(Lang.Ru, "Процессы")
            ;

        Localizator.Set("Game:Case #")
            .Set(Lang.En, "Case #")
            .Set(Lang.Ru, "Дело №")
            ;
        
       
    }

    // ===================================================================================== []
    // Tools
    private static bool _needInit = true;

    private static void InitLocalizatorIfNeed()
    {
        if (!_needInit) return;
        InitLocalizator();
        _needInit = false;
    }

    public static string Text(string key)
    {
        InitLocalizatorIfNeed();

        return Localizator.GetTranslation(key, CurrentLanguage);
    }

    private static Lang GetCookieLang()
    {
        var langInCookie = Request.Cookies[SiteModel.LangCookieName];
        if (langInCookie != null)
        {
            try
            {
                return (Lang) int.Parse(langInCookie.Value);
            }
            catch
            {
                return Lang.En;
            }
        }
        return Lang.En;
    }

    public static Lang CurrentLanguage
    {
        get { return GetCookieLang(); }
    }

}